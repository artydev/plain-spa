let e=location,t=Symbol(),n=Symbol(),r=Symbol(),o=Symbol("route");function l(e,t){let n=e.replace(/(^\/|\/$)/g,"");for(let[r,[o]]of t.entries()){if("string"==typeof o){let t=o.replace(/(^\/|\/$)/g,"");if(t===n)return[e,r];if(t.includes("*")){let o=t.replace(/[\s!#$()+,.:<=?[\\\]^{|}]/g,"\\$&").replace(/\*/g,"([^/]*)"),l=RegExp("^"+o+"$","i"),s=n.match(l);if(s)return[e,r,s.slice(1)]}}if(o instanceof RegExp){let t=n.match(o);if(t)return[e,r,t.slice(1)]}}return[e]}const s=[];let i;function a(e){const t=i,n=()=>{};i=n,m(n);const r=e(()=>{g(n),i=void 0});return i=t,r}function c(e){const t=i;i=void 0;const n=e();return i=t,n}function u(e){function t(n){if(0===arguments.length)return i&&!t._observers.has(i)&&(t._observers.add(i),i._observables.push(t)),e;e=n;const r=i;return i=void 0,t._runObservers=new Set(t._observers),t._runObservers.forEach(e=>e._fresh=!1),t._runObservers.forEach(e=>{e._fresh||e()}),i=r,e}return t.$o=!0,t._observers=new Set,t._pending=s,t}function f(e,t){function n(){const r=i;i&&i._children.push(n);const o=n._children;return g(n),n._fresh=!0,i=n,t=e(t),o.forEach(e=>{-1===n._children.indexOf(e)&&(e._fresh=!0)}),function e(t){return t.reduce((t,n)=>t.concat(n,e(n._children)),[])}(n._children).forEach(d),i=r,t}function r(){return n._fresh?n._observables.forEach(e=>e()):t=n(),t}return e._update=n,m(n),n(),r.$o=!0,r}function d(e){e._fresh&&e._observables.forEach(t=>{t._runObservers&&t._runObservers.delete(e)})}function p(e){return i&&i._cleanups.push(e),e}function h(e){return f(e),()=>g(e._update)}function g(e){e._children.forEach(g),e._observables.forEach(t=>{t._observers.delete(e),t._runObservers&&t._runObservers.delete(e)}),e._cleanups.forEach(e=>e()),m(e)}function m(e){e._observables=[],e._children=[],e._cleanups=[]}const b={},v=[];function y(e,t,n){const r=function(e){const{childNodes:t}=e;if(t&&11===e.nodeType)return t.length<2?t[0]:{_startMark:y(e,"",t[0])}}(t=function(e){return"string"==typeof e?e=document.createTextNode(e):e instanceof Node||(e=b.h(v,e)),e}(t))||t;return e.insertBefore(t,n&&n.parentNode&&n),r}function _(e){return this._listeners[e.type](e)}function x(e,t){for(let t in e)b[t]=e[t];return function(){const e=Array.from(arguments);let n;function r(o){if(null==o);else if("string"==typeof o)n?y(n,o):n=t?document.createElementNS("http://www.w3.org/2000/svg",o):document.createElement(o);else if(Array.isArray(o))n||(n=document.createDocumentFragment()),o.forEach(r);else if(o instanceof Node)n?y(n,o):n=o;else if("object"==typeof o)b.property(n,o,null,t);else if("function"==typeof o)if(n){const e=y(n,"");b.insert(n,o,e)}else n=o.apply(null,e.splice(1));else y(n,""+o)}return e.forEach(r),n}}function E(){return b.h.apply(b.h,arguments)}b.insert=function(e,t,n,r,o){return e=n&&n.parentNode||e,o=o||r instanceof Node&&r,t===r||(r&&"string"!=typeof r||!("string"==typeof t||"number"==typeof t&&(t+=""))?"function"==typeof t?b.subscribe((function(){r=b.insert(e,t.call({el:e,endMark:n}),n,r,o)})):(n?r&&(o||(o=r._startMark&&r._startMark.nextSibling||n.previousSibling),function(e,t,n){for(;t&&t!==n;){const n=t.nextSibling;e===t.parentNode&&e.removeChild(t),t=n}}(e,o,n)):e.textContent="",r=null,t&&!0!==t&&(r=y(e,t,n))):(null!=r&&e.firstChild?n?(n.previousSibling||e.lastChild).data=t:e.firstChild.data=t:n?y(e,t,n):e.textContent=t,r=t)),r},b.property=function(e,t,n,r,o){if(null!=t)if(!n||"attrs"===n&&(r=!0))for(n in t)b.property(e,t[n],n,r,o);else"o"!==n[0]||"n"!==n[1]||t.$o?"function"==typeof t?b.subscribe((function(){b.property(e,t.call({el:e,name:n}),n,r,o)})):o?e.style.setProperty(n,t):r||"data-"===n.slice(0,5)||"aria-"===n.slice(0,5)?e.setAttribute(n,t):"style"===n?"string"==typeof t?e.style.cssText=t:b.property(e,t,null,r,!0):("class"===n&&(n+="Name"),e[n]=t):function(e,t,n){t=t.slice(2).toLowerCase(),n?e.addEventListener(t,_):e.removeEventListener(t,_);(e._listeners||(e._listeners={}))[t]=n}(e,n,t)},b.add=y,b.h=x({subscribe:h,cleanup:p,root:a,sample:c}),b.hs=x({subscribe:h,cleanup:p,root:a,sample:c},!0),b.h=x({subscribe:h,cleanup:p,root:a,sample:c}),b.hs=x({subscribe:h,cleanup:p,root:a,sample:c},!0);const N=({name:e})=>E("h1",{class:"title text-4"},"Hello ",e),w=()=>E(N,{name:"World"}),S=()=>{const e=u(""),t=u([]),n=localStorage.getItem("app.todo");return n&&t(JSON.parse(n)),E([E("style",null,".control {\n        margin-bottom: var(--space-xs);\n      }"),E("div",null,E("h1",{class:"title text-4"},"Todo List"),E(O,{items:t}),E("form",{onsubmit:function(n){if(n.preventDefault(),!e().length)return;t([...t(),{text:e(),id:Date.now()}]),localStorage.setItem("app.todo",JSON.stringify(t())),e("")}},E("label",{class:"label",htmlFor:"new-todo"},"What needs to be done?"),E("input",{id:"new-todo",class:"control",onchange:t=>e(t.target.value),value:e}),E("button",{class:"button is-primary is-outlined"},"Add #",()=>t().length+1)))])},O=({items:e})=>E("ul",null,function(e,t){const{subscribe:n,root:r,cleanup:o}=b;let l=document.createDocumentFragment();const s=l.appendChild(document.createTextNode("")),i=l.appendChild(document.createTextNode("")),a=new Map;function c(e){let t=a.get(e);t&&t(),a.delete(e)}return o(n(n=>{n=n||[];const o=e()||[],u=new Map,f=new Map;let d,p;l=i.parentNode;const h=Array.from(l.childNodes),g=h.indexOf(s),m=h.indexOf(i);for(d=0;d<n.length;d++)u.set(n[d],d);for(d=0;d<o.length;d++)f.set(o[d],d);for(d=p=0;d!==n.length||p!==o.length;){const e=n[d],t=o[p];if(null===e)d++;else if(o.length<=p)c(l.removeChild(b(d))),d++;else if(n.length<=d)l.insertBefore(v(t,p),b(d)||i),p++;else if(e===t)d++,p++;else{const r=f.get(e),o=u.get(t);void 0===r?(c(l.removeChild(b(d))),d++):void 0===o?(l.insertBefore(v(t,p),b(d)||i),p++):(l.insertBefore(b(o),b(d)||i),n[o]=null,p++)}}function b(e){const t=g+e+1;return t>g&&t<m&&h[t]}function v(e,n){return r(r=>(e=(e=t(e,n))instanceof Node?e:document.createTextNode(e),a.set(e,r),e))}return o.slice()})),o((function(){a.forEach(e=>e()),a.clear()})),l}(e,e=>E("li",{id:e.id},e.text))),C=()=>E("h1",{class:"title text-4"},"Not Found");const k=()=>E("header",null,E("div",{class:"box","data-theme":"light"},E("p",{class:"title text-4"},"Plain SPA"),E("nav",null,E("ul",{class:"flow-h"},E("li",null,E("a",{href:"/"},"Home")),E("li",null,E("a",{href:"/todo"},"Todo")),E("li",null,E("a",{href:"/blog/post-with-id"},"Post with ID")),E("li",null,E("a",{href:"/any-link","data-ignore-router":!0},"Ignore Router Link")),E("li",null,E("a",{href:"/not-found"},"404")))))),A=(e=>{let t={},n={},r={dispatch(e,o){if("@dispatch"!==e&&r.dispatch("@dispatch",[e,o,t[e]]),t[e]){let l,s={};t[e].forEach(e=>{let t=e(n,o);t&&"function"!=typeof t.then&&(l=n={...n,...t},s={...s,...t})}),l&&r.dispatch("@changed",s)}},get:()=>n,on:(e,n)=>((t[e]||(t[e]=[])).push(n),()=>{t[e]=t[e].filter(e=>e!==n)})};return e.forEach(e=>{e&&e(r)}),r.dispatch("@init"),r})([function(s=[]){return i=>{i.on("@init",()=>{i.dispatch(t,l(e.pathname,s))}),i.on(n,()=>{}),i.on(r,(e,r)=>{e[o].path!==r&&history.pushState(null,null,r),i.dispatch(t,l(r,s)),i.dispatch(n,i.get()[o])}),i.on(t,(e,[t,n,r=[]])=>{let l=s[n],i={};return i[o]={match:!1,path:t,params:r},l&&(i[o].match=l[1](...r)),i}),document.documentElement.addEventListener("click",t=>{t.defaultPrevented||"A"!==t.target.tagName||0!==t.target.href.indexOf(e.origin)||"_blank"===t.target.target||null!=t.target.dataset.ignoreRouter||0!==t.button||t.metaKey||t.ctrlKey||t.shiftKey||t.altKey||(t.preventDefault(),i.dispatch(r,t.target.href.slice(e.origin.length)))}),window.addEventListener("popstate",()=>{i.get()[o].path!==e.pathname&&(i.dispatch(t,l(e.pathname,s)),i.dispatch(n,i.get()[o]))})}}([["/",()=>({page:"home",component:w})],["/todo",()=>({page:"todo",component:S})],["/blog/*",e=>{return{page:"post",component:(t={id:e},E([E("h1",{class:"title text-4"},"Post"),E("p",null,JSON.stringify(t))])),id:e};var t}],["*",()=>({page:"error",component:C})]])]),T=A.get()[o];console.log(T);const $=u(T.match.component);A.on(n,(e,t)=>{console.log(t),$(t.match.component)}),document.getElementById("app").append((e=>E([E(k,null),E("main",null,E("div",{class:"box","data-theme":"light"},e))]))($));
